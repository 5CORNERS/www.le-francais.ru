$(document).ready(function(){$("audio").audioPlayer()});(function(d,e,g,b){var c="ontouchstart" in e,j=c?"touchstart":"mousedown",i=c?"touchmove":"mousemove",a=c?"touchend":"mouseup",h=c?"touchcancel":"mouseup",f=function(q){var l=Math.floor(q/3600),p=Math.floor(q%3600/60),r=Math.ceil(q%3600%60),n,m,o;if(l==0){n=""}else{n=(l.toString().length<2)?("0"+l):l}m=(p.toString().length<2)?("0"+p):p;o=(r.toString().length<2)?("0"+r):r;return n+((l==0)?"":":")+m+":"+o},k=function(l){var m=g.createElement("audio");return true;return !!(m.canPlayType&&m.canPlayType("audio/"+l.split(".").pop().toLowerCase()+";").replace(/no/,""))};d.fn.audioPlayer=function(o){var o=d.extend({classPrefix:"audioplayer",strPlay:"Play",strPause:"Pause",strVolume:"Volume"},o),l={},n={playPause:"playpause",playing:"playing",time:"time",timeCurrent:"time-current",timeDuration:"time-duration",bar:"bar",barLoaded:"bar-loaded",barPlayed:"bar-played",volume:"volume",volumeButton:"volume-button",volumeAdjust:"volume-adjust",noVolume:"novolume",mute:"mute",mini:"mini",download:"download",downloadButton:"download-button"};for(var m in n){l[m]=o.classPrefix+"-"+n[m]}this.each(function(){if(d(this).prop("tagName").toLowerCase()!="audio"){return false}var v=d(this),B=v.attr("src"),z=v.get(0).getAttribute("autoplay"),z=((z==="")||(z==="autoplay"))?true:false,L=v.get(0).getAttribute("loop"),L=((L==="")||(L==="loop"))?true:false,M=false;if(typeof B==="undefined"){v.find("source").each(function(){B=d(this).attr("src");if((typeof B!=="undefined")&&k(B)){M=true;return false}})}else{if(k(B)){M=true}}var I=d('<div class="'+o.classPrefix+'">'+((M)?d("<div>").append(v.eq(0).clone()).html():'<embed src="'+B+'" width="0" height="0" volume="100" autostart="'+z.toString()+'" loop="'+L.toString()+'" />')+'<div class="'+l.playPause+'" title="'+o.strPlay+'"><a href="#">'+o.strPlay+"</a></div></div>"),t=(M)?I.find("audio"):I.find("embed"),t=t.get(0);var w=d(t).attr("number");if((typeof w!==typeof b)&&(w!==false)){var u=I.clone()}if(M){I.find("audio").css({width:0,height:0,visibility:"hidden"});I.append('<div class="'+l.time+" "+l.timeCurrent+'"></div><div class="'+l.bar+'"><div class="'+l.barLoaded+'"></div><div class="'+l.barPlayed+'"></div></div><div class="'+l.time+" "+l.timeDuration+'"></div><div class="'+l.volume+'"><div class="'+l.volumeButton+'" title="'+o.strVolume+'"><a href="#">'+o.strVolume+'</a></div><div class="'+l.volumeAdjust+'"><div><div></div></div></div></div>');var p=d(t).attr("data-downloadable");if((typeof p!==typeof b)&&(p!==false)){var C=d(t).find("source").attr("src");I.append('<div class="'+l.download+'"><a download="true" href="'+C+'" class="'+l.downloadButton+' glyphicon glyphicon-download"></a></div>');d(t).attr("id","lesson-audio");d(t).attr("number",w)}var A=I.find("."+l.bar),q=I.find("."+l.barPlayed),J=I.find("."+l.barLoaded),E=I.find("."+l.timeCurrent),F=I.find("."+l.timeDuration),x=I.find("."+l.volumeButton),K=I.find("."+l.volumeAdjust+" > div"),s=0,y=function(N){theRealEvent=c?N.originalEvent.touches[0]:N;t.currentTime=Math.round((t.duration*(theRealEvent.pageX-A.offset().left))/A.width())},r=function(N){theRealEvent=c?N.originalEvent.touches[0]:N;t.volume=Math.abs((theRealEvent.pageY-(K.offset().top+K.height()))/K.height())};var H=t.volume,D=t.volume=0.111;if(Math.round(t.volume*1000)/1000==D){t.volume=H}else{I.addClass(l.noVolume)}F.html("&hellip;");E.text(f(0));t.addEventListener("loadeddata",function(){F.text(f(t.duration));K.find("div").height(t.volume*100+"%");s=t.volume});t.addEventListener("timeupdate",function(){E.text(f(t.currentTime));q.width((t.currentTime/t.duration)*100+"%");var N=d(t).attr("number");if((typeof N!==typeof b)&&(N!==false)){localStorage["lecon-"+N]=t.currentTime}});t.addEventListener("volumechange",function(){K.find("div").height(t.volume*100+"%");if(t.volume>0&&I.hasClass(l.mute)){I.removeClass(l.mute)}if((t.volume<=0)&&!I.hasClass(l.mute)){I.addClass(l.mute)}});t.addEventListener("ended",function(){I.removeClass(l.playing);var N=d(t).attr("number");if((typeof N!==typeof b)&&(N!==false)){localStorage.removeItem("lecon-"+N)}});A.on(j,function(N){y(N);A.on(i,function(O){y(O)})}).on(h,function(){A.off(i)});x.on("click",function(){if(I.hasClass(l.mute)){I.removeClass(l.mute);t.volume=s}else{I.addClass(l.mute);s=t.volume;t.volume=0}return false});K.on(j,function(N){r(N);K.on(i,function(O){r(O)})}).on(h,function(){K.off(i)})}else{I.addClass(l.mini)}if((typeof w!==typeof b)&&(w!==false)){if((typeof localStorage["lecon-"+w]!==typeof b)&&localStorage["lecon-"+w]!=="undefined"){t.currentTime=+localStorage["lecon-"+w]}u.addClass(l.mini);u.attr("number",u.find("audio").attr("number"));u.find("audio").remove();d(".navbar-header").prepend(u);u.find("."+l.playPause).on("click",function(N){N.preventDefault();return G(true)})}if(z){I.addClass(l.playing)}I.find("."+l.playPause).on("click",function(){return G(false)});function G(N){if(I.hasClass(l.playing)){d(this).attr("title",o.strPlay).find("a").html(o.strPlay);if(typeof u!==typeof b){if(N){I.find("."+l.playPause).attr("title",o.strPlay).find("a").html(o.strPlay)}else{u.find("."+l.playPause).attr("title",o.strPlay).find("a").html(o.strPlay)}u.removeClass(l.playing)}I.removeClass(l.playing);if(M){t.pause()}else{t.Stop()}}else{d(this).attr("title",o.strPause).find("a").html(o.strPause);if(typeof u!==typeof b){if(N){I.find("."+l.playPause).attr("title",o.strPause).find("a").html(o.strPause)}else{u.find("."+l.playPause).attr("title",o.strPlay).find("a").html(o.strPause)}u.addClass(l.playing)}I.addClass(l.playing);if(M){t.play()}else{t.Play()}}return false}v.replaceWith(I)});return this}})(jQuery,window,document);