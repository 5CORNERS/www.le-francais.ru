$(document).ready(function(){$("audio").audioPlayer()});(function(d,e,g,b){var c="ontouchstart" in e,j=c?"touchstart":"mousedown",i=c?"touchmove":"mousemove",a=c?"touchend":"mouseup",h=c?"touchcancel":"mouseup",f=function(q){var l=Math.floor(q/3600),p=Math.floor(q%3600/60),r=Math.ceil(q%3600%60),n,m,o;if(l==0){n=""}else{n=(l.toString().length<2)?("0"+l):l}m=(p.toString().length<2)?("0"+p):p;o=(r.toString().length<2)?("0"+r):r;return n+((l==0)?"":":")+m+":"+o},k=function(l){var m=g.createElement("audio");return true;return !!(m.canPlayType&&m.canPlayType("audio/"+l.split(".").pop().toLowerCase()+";").replace(/no/,""))};d.fn.audioPlayer=function(o){var o=d.extend({classPrefix:"audioplayer",strPlay:"Play",strPause:"Pause",strVolume:"Volume"},o),l={},n={playPause:"playpause",playing:"playing",time:"time",timeCurrent:"time-current",timeDuration:"time-duration",bar:"bar",barLoaded:"bar-loaded",barPlayed:"bar-played",volume:"volume",volumeButton:"volume-button",volumeAdjust:"volume-adjust",noVolume:"novolume",mute:"mute",mini:"mini",download:"download",downloadButton:"download-button"};for(var m in n){l[m]=o.classPrefix+"-"+n[m]}this.each(function(){if(d(this).prop("tagName").toLowerCase()!="audio"){return false}var v=d(this),C=v.attr("src"),z=v.get(0).getAttribute("autoplay"),z=((z==="")||(z==="autoplay"))?true:false,M=v.get(0).getAttribute("loop"),M=((M==="")||(M==="loop"))?true:false,N=false,B=v.get(0).getAttribute("set-time");if(typeof C==="undefined"){v.find("source").each(function(){C=d(this).attr("src");if((typeof C!=="undefined")&&k(C)){N=true;return false}})}else{if(k(C)){N=true}}var J=d('<div class="'+o.classPrefix+'">'+((N)?d("<div>").append(v.eq(0).clone()).html():'<embed src="'+C+'" width="0" height="0" volume="100" autostart="'+z.toString()+'" loop="'+M.toString()+'" />')+'<div class="'+l.playPause+'" title="'+o.strPlay+'"><a href="#">'+o.strPlay+"</a></div></div>"),t=(N)?J.find("audio"):J.find("embed"),t=t.get(0);var w=d(t).attr("number");if((typeof w!==typeof b)&&(w!==false)){var u=J.clone()}if(N){J.find("audio").css({width:0,height:0,visibility:"hidden"});J.append('<div class="'+l.time+" "+l.timeCurrent+'"></div><div class="'+l.bar+'"><div class="'+l.barLoaded+'"></div><div class="'+l.barPlayed+'"></div></div><div class="'+l.time+" "+l.timeDuration+'"></div><div class="'+l.volume+'"><div class="'+l.volumeButton+'" title="'+o.strVolume+'"><a href="#">'+o.strVolume+'</a></div><div class="'+l.volumeAdjust+'"><div><div></div></div></div></div>');var p=d(t).attr("data-downloadable");if((typeof p!==typeof b)&&(p!==false)&&(p!=="empty")){var D=d(t).find("source").attr("src");J.append('<div class="'+l.download+'"><a download="true" href="'+D+'" class="'+l.downloadButton+' glyphicon glyphicon-download"></a></div>');event=new CustomEvent("downloadButtonReady");d(t).attr("id","lesson-audio");d(t).attr("number",w)}else{if(p==="empty"){J.append('<div class="'+l.download+'"><a download="true" class="'+l.downloadButton+' glyphicon glyphicon-download"></a></div>')}}var A=J.find("."+l.bar),q=J.find("."+l.barPlayed),K=J.find("."+l.barLoaded),F=J.find("."+l.timeCurrent),G=J.find("."+l.timeDuration),x=J.find("."+l.volumeButton),L=J.find("."+l.volumeAdjust+" > div"),s=0,y=function(O){theRealEvent=c?O.originalEvent.touches[0]:O;t.currentTime=Math.round((t.duration*(theRealEvent.pageX-A.offset().left))/A.width())},r=function(O){theRealEvent=c?O.originalEvent.touches[0]:O;t.volume=Math.abs((theRealEvent.pageY-(L.offset().top+L.height()))/L.height())};var I=t.volume,E=t.volume=0.111;if(Math.round(t.volume*1000)/1000==E){t.volume=I}else{J.addClass(l.noVolume)}G.html("&hellip;");F.text(f(0));t.addEventListener("loadeddata",function(){G.text(f(t.duration));L.find("div").height(t.volume*100+"%");s=t.volume;t.currentTime=B;event=new CustomEvent("lessonPlayerReady");e.dispatchEvent(event)});t.addEventListener("timeupdate",function(){F.text(f(t.currentTime));q.width((t.currentTime/t.duration)*100+"%");var O=d(t).attr("number");if((typeof O!==typeof b)&&(O!==false)){localStorage["lecon-"+O]=t.currentTime}});t.addEventListener("volumechange",function(){L.find("div").height(t.volume*100+"%");if(t.volume>0&&J.hasClass(l.mute)){J.removeClass(l.mute)}if((t.volume<=0)&&!J.hasClass(l.mute)){J.addClass(l.mute)}});t.addEventListener("ended",function(){J.removeClass(l.playing);var O=d(t).attr("number");if((typeof O!==typeof b)&&(O!==false)){localStorage.removeItem("lecon-"+O);u.removeClass(l.playing)}});A.on(j,function(O){y(O);A.on(i,function(P){y(P)})}).on(h,function(){A.off(i)});x.on("click",function(){if(J.hasClass(l.mute)){J.removeClass(l.mute);t.volume=s}else{J.addClass(l.mute);s=t.volume;t.volume=0}return false});L.on(j,function(O){r(O);L.on(i,function(P){r(P)})}).on(h,function(){L.off(i)})}else{J.addClass(l.mini)}if((typeof w!==typeof b)&&(w!==false)){if((typeof localStorage["lecon-"+w]!==typeof b)&&localStorage["lecon-"+w]!=="undefined"){t.currentTime=+localStorage["lecon-"+w]}u.addClass(l.mini);u.attr("number",u.find("audio").attr("number"));u.find("audio").remove();d(".navbar-header").prepend(u);u.find("."+l.playPause).on("click",function(O){O.preventDefault();return H(true)})}if(z){J.addClass(l.playing)}J.find("."+l.playPause).on("click",function(){return H(false)});function H(O){if(J.hasClass(l.playing)){d(this).attr("title",o.strPlay).find("a").html(o.strPlay);if(typeof u!==typeof b){if(O){J.find("."+l.playPause).attr("title",o.strPlay).find("a").html(o.strPlay)}else{u.find("."+l.playPause).attr("title",o.strPlay).find("a").html(o.strPlay)}u.removeClass(l.playing)}J.removeClass(l.playing);if(N){t.pause()}else{t.Stop()}}else{d(this).attr("title",o.strPause).find("a").html(o.strPause);if(typeof u!==typeof b){if(O){J.find("."+l.playPause).attr("title",o.strPause).find("a").html(o.strPause)}else{u.find("."+l.playPause).attr("title",o.strPlay).find("a").html(o.strPause)}u.addClass(l.playing)}J.addClass(l.playing);if(N){t.play()}else{t.Play()}}return false}v.replaceWith(J)});return this}})(jQuery,window,document);