{% load static wagtailuserbar %}
{% load site_tags %}
{% load i18n %}
{% load pybb_tags i18n %}
{% load user_agents %}

<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            'gtm.start':
                new Date().getTime(), event: 'gtm.js'
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
        j.async = true;
        j.src =
            'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-WC2Q4XT');</script>
    <!-- End Google Tag Manager -->
    <!-- Google Publisher Tag -->
    <script id="googleTagServicesScript" async="async" src="https://www.googletagservices.com/tag/js/gpt.js"></script>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>{% block title %}{% if self.seo_title %}{{ self.seo_title }}{% elif self.title %}{{ self.title }}{% else %}Французский язык{% endif %}{% endblock %}{% block title_suffix %}{% endblock %}</title>

{#    <link rel="icon" href="{% static 'favicon/favicon.ico' %}">#}
{#    <link rel="apple-touch-icon" sizes="57x57" href="{% static 'favicon/apple-icon-57x57.png' %}">#}
{#    <link rel="apple-touch-icon" sizes="60x60" href="{% static 'favicon/apple-icon-60x60.png' %}">#}
{#    <link rel="apple-touch-icon" sizes="72x72" href="{% static 'favicon/apple-icon-72x72.png' %}">#}
{#    <link rel="apple-touch-icon" sizes="76x76" href="{% static 'favicon/apple-icon-76x76.png' %}">#}
{#    <link rel="apple-touch-icon" sizes="114x114" href="{% static 'favicon/apple-icon-114x114.png' %}">#}
{#    <link rel="apple-touch-icon" sizes="120x120" href="{% static 'favicon/apple-icon-120x120.png' %}">#}
{#    <link rel="apple-touch-icon" sizes="144x144" href="{% static 'favicon/apple-icon-144x144.png' %}">#}
{#    <link rel="apple-touch-icon" sizes="152x152" href="{% static 'favicon/apple-icon-152x152.png' %}">#}
{#    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'favicon/apple-icon-180x180.png' %}">#}
{#    <link rel="icon" type="image/png" sizes="192x192" href="{% static 'favicon/android-icon-192x192.png' %}">#}
{#    <link rel="manifest" href="{% url 'meta:manifest' %}">#}
{#    <meta name="msapplication-TileColor" content="#ffffff">#}
{#    <meta name="msapplication-TileImage" content="{% static 'favicon/ms-icon-144x144.png' %}">#}
{#    <meta name="theme-color" content="#ffffff">#}

    <meta name="description" content="{% block description %}{% endblock %}"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    {% block favicons %}<link rel="apple-touch-icon" sizes="180x180" href="{% url 'favicon:apple-touch-icon.png' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% url 'favicon:favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="194x194" href="{% url 'favicon:favicon-194x194.png' %}">
    <link rel="icon" type="image/png" sizes="192x192" href="{% url 'favicon:android-chrome-192x192.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% url 'favicon:favicon-16x16.png' %}">
    {% block webmanifest %}<link rel="manifest" href="{% url 'favicon:site.webmanifest' %}">{% endblock %}
    <link rel="mask-icon" href="{% url 'favicon:safari-pinned-tab.svg' %}" color="#ed1c24">
    <meta name="msapplication-TileColor" content="#337ab7">
    <meta name="theme-color" content="#337ab7">{% endblock %}


{% block js_reverse %}
	<script src="{% static 'django_js_reverse/js/reverse.js' %}"></script>
{% endblock %}
{% block bootstrap_js %}
    <script src="{% static 'components/js/jquery.js' %}"></script>
    <script src="{% static "components/js/moment.js" %}"></script>
    <script src="{% static "components/js/js.cookie.js" %}"></script>
    <script src="{% static 'js/csrf.min.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="{% static 'components/js/bootstrap.js' %}" crossorigin="anonymous"></script>
    <script type="text/javascript" src="{% static 'lib/footable-bootstrap.v3.1.6/js/footable.js' %}"></script>
{% endblock %}
{% block bootstrap_css %}
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">
    <link rel="stylesheet" href="{% static 'components/css/bootstrap.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'lib/bootstrap-social/bootstrap-social.min.css' %}">
{% endblock %}
    {% block css %}

        <link rel="stylesheet" href="{% static 'lib/audio/audioplayer.min.css' %}">

        <!-- Latest compiled and minified CSS -->


	    {# Global stylesheets #}
	    <link rel="stylesheet" type="text/css" href="{% static 'css/le_francais.min.css' %}">
        <link rel="stylesheet" href="{% static 'components/css/font-awesome.css' %}">
	    <link rel="stylesheet" type="text/css" href="{% static 'lib/footable-bootstrap.v3.1.6/css/footable.bootstrap.min.css' %}">
    {% endblock %}
		{% get_full_path as full_path %}
    {% block canonical %}<link rel="canonical" href="{% split_canonical full_path %}"/>{% endblock %}

    {% block extra_css %}
        {# Override this in templates to add extra stylesheets #}
    {% endblock %}

    {% block meta %}
        {# Override this in templates to add extra stylesheets #}
    {% endblock %}

    {% block extra_head %}

    {% endblock %}

    {% block head_advertisments %}

    {% endblock %}

    {% block site_js %}
        <script async type="text/javascript" src="{% static 'js/le_francais.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'random.min.js' %}"></script>
    {% endblock %}
</head>

<body class="body" data-spy="scroll" data-target="#myScrollspy" data-offset="15">
<!-- Google Tag Manager (noscript) -->
<noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WC2Q4XT"
            height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->
{% wagtailuserbar %}

{% block menu %}
    {% get_site_root as site_root %}
    {% top_menu parent=site_root calling_page=self %}
{% endblock %}
<div class="_content">
    {% block content %}{% endblock %}
</div>

{% block payment_modals %}
    {% if 'payment_success' in request.GET %}
        <div class="modal" id="success-donation-modal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4>Спасибо за Ваше решение нас
                            поддержать!</h4>
                        <button type="button" class="close"
                                data-dismiss="modal"
                                aria-label="Close"><span
                                aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <p>Спасибо за Ваше пожертвование! Вы нам очень помогли!</p>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary"
                                data-dismiss="modal">Закрыть
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal" id="success-payment-modal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
	                {% if not user.saw_message %}
		                <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4>Спасибо за Ваше решение нас поддержать!</h4>
                    </div>
                    <div class="modal-body">
                        <p>Добровольное пожертвование — это поступок, и мы это по-настоящему ценим.</p>
                        <p>Теперь Вы можете благодарить нас за наш труд чашечками кофе :)</p>
                    </div>
	                {% else %}
		                <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4>Спасибо, что остаётесь с нами!</h4>
                    </div>
                    <div class="modal-body">
                        <p>Вы не пожалеете. Мы продолжим наш каждодневный труд над проектом, чтбы позволить вам получить максимум знаний, быстрее выучить французский — и получать от этого удовольствие. :)</p>
                    </div>
	                {% endif %}
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-dismiss="modal">Закрыть</button>
                    </div>
                </div>
            </div>
        </div>
    {% elif "payment_fail" in request.GET %}
        <div class="modal" id="fail-payment-modal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">Ошибка!
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    </div>
                    <div class="modal-body">
                        <p>Что-то пошло не так.</p>
                        <p>:(</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
    <div class="bottom-message row" id="cookiesMessage"
         style="display: none;background-color: #333333eb;color:#ddd">
        <div class="bottom-message-content col-12 col-md-9 col-xl-6">
            <div class="bottom-message-description">
                <div class="bottom-message-text text-left">
                    <img class="mr-4" src="{% static 'images/cookie.png' %}" alt="cookie" style="height:50px;float:left">
                    {% trans "We use cookies on this site to enhance your user experience." %}
                    <div class="btn btn-sm btn-primary bottom-message-button mt-0"
                     id="cookiesMessageOk">
                    OK
                </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block footer %}
{% include 'tags/footer.html' %}
{% endblock %}
{# Global javascript #}
{% block js %}
	<script async src="{% static 'lib/audio/audioplayer.min.js' %}"></script>
	    {% get_full_path as full_path %}
    {% if not country_code in 'RU,KZ,GE,UA,BY' and not request.session.session_key %}
        <script>
            $(document).ready(function () {
                let message = $('#cookiesMessage');
                message.slideDown(1000);
                $('#cookiesMessageOk').click(function (e) {
                    message.slideUp(1000);
                })
            })
        </script>
    {% endif %}
	{% if 'payment_success' in request.GET and request.GET.modal_open == 'success-payment-modal' %}
	    <script>
	      $(document).ready(function () {
	        $('#success-payment-modal').modal('show');
	        history.pushState({}, title='',url="{{ full_path }}");
	      })
	    </script>
    {% elif 'payment_success' in request.GET and request.GET.modal_open == 'success-donation-modal' %}
        <script>
			$(document).ready(function () {
				$('#success-donation-modal').modal('show');
				history.pushState({}, title = '', url = "{{ full_path }}?payment_success=true");
			})
		</script>
	{% elif 'payment_fail' in request.GET and request.GET.modal_open == 'fail-payment-modal' %}
	    <script>
	      $(document).ready(function () {
	        $('#fail-payment-modal').modal('show');
	        history.pushState(url="{{ full_path }}");
	      })
	    </script>
	{% endif %}
    {% if request.user.is_authenticated %}<script>
        // Send user timezone
        const user_tz = '{{ request.user.timezone }}';
        const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
        $(document).ready(function () {
            if (user_tz !== tz){
                $.ajax(Urls['custom_user:update_timezone'](), {
                    type: 'post',
                    data: tz,
                    headers: {"X-CSRFToken": csrftoken},
                    dataType: 'json',
                });
            }
        })
    </script>{% endif %}

{% endblock %}
{% block extra_js %}
    {# Override this in templates to add extra javascript #}
{% endblock %}
</body>
</html>
