{% extends 'base.html' %}
{% load static conjugation_tags%}
{% block extra_head %}
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
{% endblock %}
{% block extra_css %}
    <style>
        .noselect {
            -webkit-touch-callout: none; /* iOS Safari */
            -webkit-user-select: none; /* Safari */
            -khtml-user-select: none; /* Konqueror HTML */
            -moz-user-select: none; /* Firefox */
            -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none;
            /* Non-prefixed version, currently
                                             supported by Chrome and Opera */
        }
        .col-fixed-210{
            height: 40px;
            width: 230px;
            position: absolute;
            padding-left: 15px;
            z-index: 1;
        }
        .col-offset-210{
            padding-left: 245px;
            z-index: 0;
        }
        .col-fixed-315{
            height: 40px;
            width: 335px;
            position: absolute;
            padding-left: 15px;
            z-index: 1;
        }
        .col-offset-315{
            padding-left: 350px;
            z-index: 0;
        }
        .row {
            margin-bottom: 0.5em;
        }

{#        .row-eq-height {#}
{#            display: -webkit-box;#}
{#            display: -webkit-flex;#}
{#            display: -ms-flexbox;#}
{#            display: flex;#}
{#        }#}

        .tenses i {
            font-style: normal;
            color: #337ab7;
            font-weight: bold;
        {#            font-weight: bold#}
        }

        .tenses b {
            color: #d83131;
            font-weight: bold
        }

        .tab-content > .active {
            display: inline;
        }

        .tenses .block {
            border-color: #ddd;
        }

        .tenses .block {
            margin: 0 0 20px 0;
            padding: 10px;
            border-width: 1px;
            border-style: solid;
            border-radius: 4px;
        }
    </style>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <style>
        .ui-autocomplete-loading {
            background: white url("{% static 'images/ui-anim_basic_16x16.gif' %}") right center no-repeat;
        }
    </style>
{% endblock %}
{% block extra_js %}
    <script>
        {% comment %}$(function () {
            $("#verb").autocomplete({
                source: "/conjugation/verbs_autocomplete/",
                minLength: 2
            });
        });{% endcomment %}
        $("#search-verb")["autocomplete"]({
            source: "{% url 'conjugation:autocomplete' %}",
            minLength: 1,
            focus: function (event, ui) {
                $("#search-verb").val(ui.item["verb"]);
                return false;
            },
            select: function (event, ui) {
                event.preventDefault();
                window.location.href = ui.item['url'];
            }
        })["data"]("ui-autocomplete")["_renderItem"] = function (a, b) {
            return $("<li>")["data"]("ui-menu-item", b)["append"]("<a href='" + b["url"] + "'>" + b["html"] + "</a>")["appendTo"](a);
        };

        function see_less() {
            $.each($(".in_short_list"), function (i, v) {
                v.style.display = "none";
            });
            $("#more_tab").removeClass("active");
            $("#less_tab").addClass("active")
        }

        function see_more() {
            $.each($(".in_short_list"), function (i, v) {
                v.style.display = "block";
            });
            $("#more_tab").addClass("active");
            $("#less_tab").removeClass("active");
        }
    </script>
{% endblock %}

{% block content %}
    {% load i18n site_tags %}
    <div class="container-fluid">
    <div class="row main_row">
    <div class="col-sm-12 col-md-9 main">

        <div class="row">
            <div class="col-xs-12">
                <form id="search" action="{% url 'conjugation:search' %}", method="post">
                    <div class="input-group input-group-lg">
                        <input name="verb" type="text" id="search-verb" size="30" class="form-control" value="{{ v.infinitive }}">
                        <div class="input-group-btn input-group-btn-lg">
                            <input name="submit" type="submit" id="search-submit" class="btn" value="Спрягнуть">
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="row">
            {% if forms_count > 1%}
            <div class="{% if forms_count == 2 %}col-fixed-210{% elif forms_count == 3 %}col-fixed-315{% endif %}">
                <ul class="nav nav-pills">
                    {% for i in forms_range %}
                    <li {% if i == 1 %}class="active"{% endif %}><a data-toggle="pill" href=".form{{ forloop.counter0 }}">Вариант {{ i }}</a></li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}
            <div class="col-xs-12 {% if forms_count == 2 %} col-offset-210{% elif forms_count == 3 %} col-offset-315{% else %}{% endif %}">
                <div class="btn">
                    <a class="btn btn-primary" href="{% option_url 'gender' %}">{% if not feminin%}В женском роде{% else %}В мужском роде{% endif %}</a>
                    {% if v.reflexive%}<a class="btn btn-primary" href="{% option_url 'se' %}">{% if not reflexive%}В возвратной форма{% else %}В невозвратной форма{% endif %}</a>{% endif %}
                </div>
            </div>
        </div>
        <div class="row">
            <ul class="nav nav-tabs">
                <li class="nav-item active" id="less_tab">
                    <a class="nav-link noselect" onclick="see_less()">Сокращенная версия</a>
                </li>
                <li class="nav-item" id="more_tab" >
                    <a class="nav-link noselect" onclick="see_more()">Полная версия</a>
                </li>
            </ul>
        </div>
        {% for mood in table.moods %}
        <div class="mood">
            <div class="row mood_name">
                <div class="col-xs-12">
                    <div class="{% comment %}{{ mood.class }}{% endcomment %}"><h2>{{ mood.name | safe }}</h2></div>
                </div>
            </div>
            <div class="tenses">
            {% for tense in mood.tenses %}
                <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 tense block {% if tense.is_in_short_list %}in_short_list{% endif %}" {% if tense.is_in_short_list %}style="display: none" {% endif %}>
                    <div id="{% comment %}{{ tense.id }}{% endcomment %}" class="tense_name"><h3>{{ tense.name }}</h3></div>
                    <p class="person">{% for person in tense.persons %}{{ person.part_0 | safe }}{% if person.more_than_one %}<r class="tab-content">{% for form in person.forms %}<r class="tab-pane fade {% if forloop.counter0 == 0 %}in active{% endif %} form{{ forloop.counter0 }}">{{ form | safe }}</r>{% endfor %}</r>{% else %}{{ person.forms.0 | safe }}{% endif %}{{ person.part_2 | safe }}<br>{% endfor %}</p>
                </div>
            {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="hidden-xs hidden-sm col-md-3 sidebar-right"></div>
    </div>
    </div>
{% endblock %}